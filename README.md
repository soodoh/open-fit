# Open Fit

A fitness tracking application built with Next.js and Convex.

## Getting Started

### Prerequisites

- [Node.js](https://nodejs.org/) 18+
- [pnpm](https://pnpm.io/) package manager
- A [Convex](https://convex.dev/) account (free tier available)

### 1. Clone and Install Dependencies

```bash
git clone https://github.com/your-username/open-fit.git
cd open-fit
pnpm install
```

### 2. Create your .env.local

```env
NEXT_PUBLIC_CONVEX_URL='http://localhost:3210'
CONVEX_SELF_HOSTED_URL='http://localhost:3210'
INSTANCE_NAME='convex-self-hosted'
INSTANCE_SECRET='...' # Generated by `openssl rand -hex 32`
CONVEX_SELF_HOSTED_ADMIN_KEY='...' # Will update this in a later section
```

### 3. Set Up Convex

Spin up a local docker instance for Convex backend & dashboard. The `compose.yml` file included in this repo should take care of everything for you.

```bash
docker compose up -d
```

### 4. Update CONVEX_SELF_HOSTED_ADMIN_KEY

Once the docker containers are running, obtain the admin key generated from within the Convex backend container. FYI the name of your container is probably `open-fit-convex-backend-1`, but you can verify this by checking `docker ps`.

```bash
docker exec -it open-fit-convex-backend-1 bash
```

Then run the following inside the container shell.

```bash
./generate_admin_key.sh
```

Paste the output in your `.env.local` as the value for `CONVEX_SELF_HOSTED_ADMIN_KEY`.

Note:
Running `./generate_admin_key.sh` will return a new key every time. But as long as the `INSTANCE_SECRET` env variable is consistent, any admin keys generated in the future will still work.

### 5. Deploy schema & functions to Convex container

Now that the containers are running & .env.local is updated accordingly, run the following.

```bash
npx convex deploy
```

### 6. Generate JWT keys for auth & apply to Convex function environment variables

Convex auth requires `JWT_PRIVATE_KEY` and `JWKS` to be in the environment for Convex functions. Unfortunately, this is a different environment than the Convex backend container itself, so it cannot be simply included in the `.env.local` (for now).

```bash
node ./scripts/generateKeys.mjs

# Paste the corresponding output here
npx convex env set -- JWT_PRIVATE_KEY "paste from previous command"
npx convex env set -- JWKS "paste from previous command"
```

### 7. Seed the Database

Seed the database with exercises and units:

```bash
pnpm convex run seed:run
```

This creates:
- 400+ exercises with muscle groups, equipment, and instructions
- Repetition units (Repetitions, Seconds, Minutes, Miles, Kilometers)
- Weight units (lb, kg, Body Weight)

### 8. Run the Development Server

```bash
pnpm dev
```

Open [http://localhost:3000](http://localhost:3000) and create an account to get started.

### 9. (Optional) Seed Mock Data for Testing

After creating an account, you can seed test data (50 routines with days and sets):

```bash
pnpm convex run seed:mockUserData '{"email": "your@email.com"}'
```

Replace `your@email.com` with the email you registered with.

## Project Structure

```
├── app/                    # Next.js app router pages
├── components/             # React components
│   ├── auth/              # Authentication components
│   ├── exercises/         # Exercise-related components
│   ├── routines/          # Routine management components
│   ├── sessions/          # Workout session components
│   ├── ui/                # Shared UI components
│   └── workoutSet/        # Workout set components
├── convex/                 # Convex backend
│   ├── mutations/         # Data mutation functions
│   ├── queries/           # Data query functions
│   ├── schema.ts          # Database schema
│   └── seed.ts            # Database seeding
├── lib/                    # Utility functions and types
└── public/                 # Static assets
```

## Tech Stack

- **Frontend**: Next.js 16, React 19, TypeScript
- **Backend**: Convex (real-time database and serverless functions)
- **Authentication**: Convex Auth with email/password
- **Styling**: Tailwind CSS, shadcn/ui components
- **Drag & Drop**: dnd-kit
